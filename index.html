<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TKO WH-T4 原料組: 原料進口流程互動指南</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .step-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .step-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .interactive-item {
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
        }
        .interactive-item:hover, .interactive-item:focus {
            background-color: #f0f9ff; /* light-blue-50 */
            transform: translateX(4px);
            outline: none;
        }
        .info-popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.95);
            z-index: 100;
            opacity: 0;
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        .info-popup.visible {
            display: block;
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }
        .info-popup-backdrop {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 99;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .info-popup-backdrop.visible {
            display: block;
            opacity: 1;
        }
        /* Knowledge Card Flip */
        .flip-card { perspective: 1000px; }
        .flip-card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s; transform-style: preserve-3d; }
        .flip-card.flipped .flip-card-inner { transform: rotateY(180deg); }
        .flip-card-front, .flip-card-back { position: absolute; width: 100%; height: 100%; -webkit-backface-visibility: hidden; backface-visibility: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 1.5rem; border-radius: 0.75rem; }
        .flip-card-back { transform: rotateY(180deg); align-items: flex-start; text-align: left;}

        /* Checklist style */
        .checklist-item.checked .checklist-icon {
            background-color: #22c55e; /* green-500 */
            border-color: #22c55e; /* green-500 */
        }
        .checklist-item.checked .checklist-icon svg {
            display: block;
        }
        .org-code {
            background-color: #e0e7ff;
            color: #4338ca;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', Courier, monospace;
            font-weight: bold;
        }
        /* AI Assistant Styles */
        .chat-bubble {
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 15px;
            white-space: pre-wrap; /* Allows line breaks in AI response */
        }
        .user-bubble {
            background-color: #3b82f6; /* blue-500 */
            color: white;
            border-bottom-right-radius: 5px;
            align-self: flex-end;
        }
        .ai-bubble {
            background-color: #e5e7eb; /* gray-200 */
            color: #1f2937; /* gray-800 */
            border-bottom-left-radius: 5px;
            align-self: flex-start;
        }
        .typing-indicator span {
            height: 8px;
            width: 8px;
            background-color: #9ca3af; /* gray-400 */
            border-radius: 50%;
            display: inline-block;
            animation: bounce 1.4s infinite ease-in-out both;
        }
        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1.0); }
        }
    </style>
</head>
<body class="bg-slate-50 text-gray-800">

    <!-- Header -->
    <header class="bg-gradient-to-r from-sky-600 to-indigo-700 text-white shadow-lg">
        <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
            <h1 class="text-4xl font-bold">TKO WH-T4 原料組: 原料進口流程互動指南</h1>
            <p class="mt-2 text-indigo-200 text-lg">歡迎來到 TKO 原料組的進口操作流程介紹。本指南將為您呈現我們如何將原料從香港，順利、合規地運送到位於南沙及番禺的工廠。</p>
        </div>
    </header>

    <main class="max-w-7xl mx-auto py-10 sm:px-6 lg:px-8">
        <!-- Main Flow -->
        <div class="bg-white p-8 rounded-xl shadow-md mb-12 border border-slate-200">
            <h2 class="text-3xl font-semibold mb-6 text-center text-slate-800">我們的日常運作：三大核心環節</h2>
            <div class="relative flex flex-col md:flex-row items-center justify-between space-y-8 md:space-y-0 md:space-x-8">
                <!-- Connecting line for desktop -->
                <div class="hidden md:block absolute top-1/2 left-0 w-full h-0.5 bg-slate-200" style="z-index: 0;"></div>
                
                <a href="#step1" class="step-card relative text-center p-6 bg-white border-2 border-sky-200 rounded-xl w-full md:w-1/3 z-10">
                    <div class="flex items-center justify-center mb-4 bg-sky-100 rounded-full w-16 h-16 mx-auto">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-sky-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" /></svg>
                    </div>
                    <h3 class="text-xl font-bold text-sky-800">1. 原料收貨與系統錄入</h3>
                </a>
                
                <a href="#step2" class="step-card relative text-center p-6 bg-white border-2 border-indigo-200 rounded-xl w-full md:w-1/3 z-10">
                     <div class="flex items-center justify-center mb-4 bg-indigo-100 rounded-full w-16 h-16 mx-auto">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                    </div>
                    <h3 class="text-xl font-bold text-indigo-800">2. 貿易模式選擇與文件準備</h3>
                </a>

                <a href="#step3" class="step-card relative text-center p-6 bg-white border-2 border-emerald-200 rounded-xl w-full md:w-1/3 z-10">
                     <div class="flex items-center justify-center mb-4 bg-emerald-100 rounded-full w-16 h-16 mx-auto">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-emerald-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path d="M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10l2 2h8a1 1 0 001-1z" /><path stroke-linecap="round" stroke-linejoin="round" d="M18 18h1a1 1 0 001-1v-3.354a1.5 1.5 0 00-.44-1.06l-2.12-2.122a1.5 1.5 0 00-1.06-.44H13V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10l2 2h8a1 1 0 001-1z" /></svg>
                    </div>
                    <h3 class="text-xl font-bold text-emerald-800">3. 裝車、申報與付運</h3>
                </a>
            </div>
        </div>

        <!-- Step 1 -->
        <section id="step1" class="mb-12">
            <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200">
                <h2 class="text-3xl font-bold text-sky-800 border-l-4 border-sky-500 pl-4 mb-8">第一步：原料收貨與系統錄入</h2>
                <p class="mb-6 text-lg"><strong>學習目標：</strong>了解香港倉庫的收貨標準、系統錄入操作，以及此環節如何為後續步驟提供基礎數據。</p>
                
                <div class="bg-slate-100 p-6 rounded-lg mb-8">
                    <h4 class="font-bold text-xl mb-2 text-slate-700">職責說明</h4>
                    <p>本環節的核心是香港倉庫團隊。他們的工作是根據公司制定的標準，驗證供應商來貨，並將準確的貨物資訊錄入到 Oracle 系統中。</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-slate-50 p-6 rounded-lg">
                        <h4 class="font-bold text-xl mb-2">互動式文件解讀：《供應商交貨要求》</h4>
                        <p class="text-sm text-gray-500 mb-4">點擊下方欄位，查看其在工作中的實際應用。</p>
                        <div class="space-y-3">
                            <div class="interactive-item border-b pb-3 pt-3" tabindex="0" onclick="showPopup('popup1')">
                                <span class="font-semibold">訂單編號及項號 (PO number and PO line)</span><span class="text-blue-500 float-right font-semibold">點擊查看 &rarr;</span>
                            </div>
                            <div class="interactive-item border-b pb-3 pt-3" tabindex="0" onclick="showPopup('popup2')">
                                <span class="font-semibold">不同訂單不可混合在同一托盤</span><span class="text-blue-500 float-right font-semibold">點擊查看 &rarr;</span>
                            </div>
                             <div class="interactive-item border-b pb-3 pt-3" tabindex="0" onclick="showPopup('popup3')">
                                <span class="font-semibold">單個包裝貨物的毛重</span><span class="text-blue-500 float-right font-semibold">點擊查看 &rarr;</span>
                            </div>
                            <div class="interactive-item border-b pb-3 pt-3" tabindex="0" onclick="showPopup('popup4')">
                                <span class="font-semibold">原產國 (Country of Origin)</span><span class="text-blue-500 float-right font-semibold">點擊查看 &rarr;</span>
                            </div>
                            <div class="interactive-item border-b pb-3 pt-3" tabindex="0" onclick="showPopup('popup5')">
                                <span class="font-semibold">FSC 物料要求</span><span class="text-blue-500 float-right font-semibold">點擊查看 &rarr;</span>
                            </div>
                             <div class="interactive-item border-b pb-3 pt-3" tabindex="0" onclick="showPopup('popup6')">
                                <span class="font-semibold">詳細送貨文件</span><span class="text-blue-500 float-right font-semibold">點擊查看 &rarr;</span>
                            </div>
                            <div class="interactive-item border-b pb-3 pt-3" tabindex="0" onclick="showPopup('popup7')">
                                <span class="font-semibold">實物外箱標籤要求</span><span class="text-blue-500 float-right font-semibold">點擊查看 &rarr;</span>
                            </div>
                            <div class="interactive-item pt-3" tabindex="0" onclick="showPopup('popup8')">
                                <span class="font-semibold">核對卡板及包裝資訊</span><span class="text-blue-500 float-right font-semibold">點擊查看 &rarr;</span>
                            </div>
                        </div>
                    </div>
                    <div class="bg-slate-50 p-6 rounded-lg">
                        <h4 class="font-bold text-xl mb-2">流程展示：Oracle 系統收貨</h4>
                         <p class="text-sm text-gray-500 mb-4">基於SOP LGW-02的標準流程。</p>
                        <ul class="space-y-4">
                            <li class="flex items-start">
                                <div class="bg-sky-500 text-white rounded-full h-8 w-8 flex items-center justify-center font-bold mr-4 flex-shrink-0">1</div>
                                <div><strong class="block">三方核對</strong>將供應商<strong>送貨單</strong>、系統中的<strong>「PX Open Purchase Orders by Buyer (HK)」報表</strong>、以及<strong>實物資訊</strong>（實際數量和標籤）進行交叉核對。</div>
                            </li>
                            <li class="flex items-start">
                                <div class="bg-sky-500 text-white rounded-full h-8 w-8 flex items-center justify-center font-bold mr-4 flex-shrink-0">2</div>
                                <div><strong class="block">收貨</strong>在對應的 Oracle Org 中執行收貨。若差異超出10%，需通知採購部並等待指示。</div>
                            </li>
                            <li class="flex items-start">
                                <div class="bg-sky-500 text-white rounded-full h-8 w-8 flex items-center justify-center font-bold mr-4 flex-shrink-0">3</div>
                                <div><strong class="block">標識與報告</strong>系統收貨後，列印收貨標籤並粘貼在實體貨物上。完成後生成的「AD Warehouse Receiving Report」(即 Oracle 收貨報告) 是製作報關文件的關鍵依據。</div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Step 2 -->
        <section id="step2" class="mb-12">
            <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200">
                <h2 class="text-3xl font-bold text-indigo-800 border-l-4 border-indigo-500 pl-4 mb-8">第二步：貿易模式選擇與文件準備</h2>
                <p class="mb-6 text-lg"><strong>學習目標：</strong>了解「進料加工 (CLKK)」與「一般貿易 (GT)」的應用場景、對應的 Oracle Org，並熟悉兩種模式下所需準備的標準報關文件。</p>
                
                <h4 class="font-bold text-xl mb-4 text-center">知識卡片：兩種貿易模式 (點擊卡片翻轉)</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                    <div class="flip-card h-56 cursor-pointer" tabindex="0" onclick="this.classList.toggle('flipped')">
                        <div class="flip-card-inner">
                            <div class="flip-card-front bg-indigo-200 shadow-lg">
                                <h5 class="text-2xl font-bold text-indigo-900">進料加工 (CLKK)</h5>
                                <p class="text-indigo-700">(Contract Manufacturing)</p>
                            </div>
                            <div class="flip-card-back bg-indigo-50 shadow-lg">
                                <p><strong>核心：</strong>使用「加工貿易手冊」。</p>
                                <p><strong>特點：</strong>進口料件享受保稅，成品復出口。</p>
                                <p><strong>適用場景：</strong>手冊內有料號且餘額充足。</p>
                                <p class="mt-2"><strong>Oracle Orgs:</strong><br>
                                    南沙: <span class="org-code">NSB</span><br>
                                    番禺: <span class="org-code">PYB</span>, <span class="org-code">PRB</span>
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="flip-card h-56 cursor-pointer" tabindex="0" onclick="this.classList.toggle('flipped')">
                        <div class="flip-card-inner">
                            <div class="flip-card-front bg-green-200 shadow-lg">
                                <h5 class="text-2xl font-bold text-green-900">一般貿易 (GT)</h5>
                                <p class="text-green-700">(General Trade)</p>
                            </div>
                            <div class="flip-card-back bg-green-50 shadow-lg">
                                <p><strong>核心：</strong>按一般貨物辦理進口手續。</p>
                                <p><strong>特點：</strong>進口時需依法繳納關稅。</p>
                                <p><strong>適用場景：</strong>手冊額度不足或不適用物料。</p>
                                <p class="mt-2"><strong>Oracle Orgs:</strong><br>
                                   南沙: <span class="org-code">NSL</span> (原料), <span class="org-code">NST</span> (零件/機器)<br>
                                   番禺: <span class="org-code">PYL</span>, <span class="org-code">PRL</span> (原料), <span class="org-code">PYT</span> (零件/機器)
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <h4 class="font-bold text-xl mb-2">文件清單展示</h4>
                 <div class="w-full bg-slate-50 rounded-lg p-4">
                    <div class="flex border-b border-slate-200">
                        <button class="tab-button py-3 px-6 bg-white text-indigo-600 border-b-2 border-indigo-500 font-semibold rounded-t-md" onclick="openTab(event, 'clkk')">進料加工 (CLKK)</button>
                        <button class="tab-button py-3 px-6 text-slate-500 font-semibold" onclick="openTab(event, 'gt')">一般貿易 (GT)</button>
                    </div>
                    <div id="clkk" class="tab-content p-6">
                        <h5 class="font-bold mb-2">所需文件:</h5>
                        <ul class="list-disc list-inside space-y-1">
                            <li>發票 (Invoice)</li>
                            <li>裝箱單 (Packing List)</li>
                            <li>內地及香港海關陸路進/出口載貨清單 (六聯單)</li>
                        </ul>
                        <p class="mt-3 text-sm text-gray-600 bg-gray-100 p-3 rounded-md"><strong>文件準備依據：</strong>CLKK 手冊合同及 Oracle 收貨報告 (AD Warehouse Receiving Report)。</p>
                    </div>
                    <div id="gt" class="tab-content p-6" style="display:none;">
                        <h5 class="font-bold mb-2">所需文件:</h5>
                         <ul class="list-disc list-inside space-y-1">
                            <li>發票 (Invoice)</li>
                            <li>裝箱單 (Packing List)</li>
                            <li>內地及香港海關陸路進/出口載貨清單 (六聯單)</li>
                            <li>合同 (Contract)</li>
                        </ul>
                        <div class="mt-3 text-sm text-gray-600 bg-gray-100 p-3 rounded-md space-y-2">
                           <p><strong>文件準備依據分兩種情況：</strong></p>
                           <p><strong>1. 標準GT進口 (收貨在 <span class="org-code">NSL</span>/<span class="org-code">PYL</span>/<span class="org-code">PRL</span> 等):</strong> 主要依據 Oracle 收貨報告 (AD Warehouse Receiving Report)。</p>
                           <p><strong>2. 內部GT轉移 (如補貨/Sample/零件):</strong> 涉及內部公司間交易 (例如 <span class="org-code">NST</span> 賣給 <span class="org-code">NSL</span>，<span class="org-code">PYT</span> 賣給 <span class="org-code">PYL</span>)。此類流程文件準備或需依據內部轉移訂單(ICPO)。</p>
                        </div>
                        <p class="mt-3 text-sm text-red-600 bg-red-100 p-3 rounded-md"><strong>特別注意：</strong>無論哪種GT，新機器/物料都需先從內地採購/Sourcing Team取得「GT 信息一覽表」或「归类要素一覽表」。</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Step 3 -->
        <section id="step3" class="mb-12">
            <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200">
                <h2 class="text-3xl font-bold text-emerald-800 border-l-4 border-emerald-500 pl-4 mb-8">第三步：裝車、申報與付運</h2>
                <p class="mb-6 text-lg"><strong>學習目標：</strong>了解貨物出庫前的最終操作步驟，包括裝車、電子申報及文件交接。</p>

                <div class="bg-slate-100 p-6 rounded-lg mb-8">
                    <h4 class="font-bold text-xl mb-2 text-slate-700">流程概覽</h4>
                    <p>報關文件準備齊全後，就進入了出貨的最後環節。此階段的關鍵是確保實體操作與文件記錄的同步和一致性。</p>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="bg-slate-50 p-6 rounded-lg">
                        <h4 class="font-bold text-xl mb-4">互動式操作清單 (點擊以了解詳情)</h4>
                        <div class="space-y-3">
                            <div class="checklist-item flex items-center p-4 bg-white rounded-lg cursor-pointer hover:bg-gray-50 shadow-sm" tabindex="0" onclick="toggleCheck(this); showPopup('popup_truck')">
                                <div class="checklist-icon h-6 w-6 rounded-full border-2 border-gray-300 mr-4 flex-shrink-0 flex items-center justify-center">
                                    <svg class="h-4 w-4 text-white hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                                </div>
                                <span class="font-medium">安排車輛</span>
                            </div>
                             <div class="checklist-item flex items-center p-4 bg-red-50 rounded-lg cursor-pointer hover:bg-red-100 shadow-sm" tabindex="0" onclick="toggleCheck(this); showPopup('popup_crosscheck')">
                                <div class="checklist-icon h-6 w-6 rounded-full border-2 border-red-400 mr-4 flex-shrink-0 flex items-center justify-center">
                                    <svg class="h-4 w-4 text-white hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                                </div>
                                <span class="font-medium text-red-700">單貨核對 (非常重要)</span>
                            </div>
                            <div class="checklist-item flex items-center p-4 bg-white rounded-lg cursor-pointer hover:bg-gray-50 shadow-sm" tabindex="0" onclick="toggleCheck(this); showPopup('popup_rocars')">
                                <div class="checklist-icon h-6 w-6 rounded-full border-2 border-gray-300 mr-4 flex-shrink-0 flex items-center justify-center">
                                    <svg class="h-4 w-4 text-white hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                                </div>
                                <span class="font-medium">香港出口申報 (Rocars)</span>
                            </div>
                            <div class="checklist-item flex items-center p-4 bg-white rounded-lg cursor-pointer hover:bg-gray-50 shadow-sm" tabindex="0" onclick="toggleCheck(this); showPopup('popup_mainland')">
                                <div class="checklist-icon h-6 w-6 rounded-full border-2 border-gray-300 mr-4 flex-shrink-0 flex items-center justify-center">
                                    <svg class="h-4 w-4 text-white hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                                </div>
                                <span class="font-medium">內地進口申報 (公路艙單)</span>
                            </div>
                            <div class="checklist-item flex items-center p-4 bg-white rounded-lg cursor-pointer hover:bg-gray-50 shadow-sm" tabindex="0" onclick="toggleCheck(this); showPopup('popup_loading')">
                                <div class="checklist-icon h-6 w-6 rounded-full border-2 border-gray-300 mr-4 flex-shrink-0 flex items-center justify-center">
                                    <svg class="h-4 w-4 text-white hidden" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                                </div>
                                <span class="font-medium">裝車與文件交接</span>
                            </div>
                        </div>
                    </div>
                    <div class="bg-emerald-50 border-l-4 border-emerald-400 p-6 rounded-r-lg">
                        <h4 class="font-bold text-xl mb-2">知識點說明</h4>
                        <p class="font-semibold text-emerald-800">為什麼需要 特定"貿易模式"?</p>
                        <p class="text-gray-700 mt-2">選擇正確的貿易模式是為了確保<strong>成本效益</strong>與<strong>海關合規</strong>。根據物料的最終用途選擇合適的模式，是我們工作的關鍵決策之一。</p>
                        <h5 class="font-semibold text-emerald-800 mt-4">CLKK vs GT 簡單比較：</h5>
                        <ul class="list-disc list-inside mt-2 text-gray-700 space-y-1">
                            <li><strong>進料加工 (CLKK):</strong> 簡單來說就是「免稅進口，監管加工」。進口原料時暫時不用繳稅（保稅），但整個過程受海關嚴格監管，成品原則上需要再出口。</li>
                            <li><strong>一般貿易 (GT):</strong> 可以理解為「正常付稅進口」。貨物進口時直接繳納關稅，之後就可以在國內自由銷售或使用，流程相對靈活。</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Gemini AI Assistant -->
        <section id="ai-assistant" class="mb-12">
            <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200">
                <h2 class="text-3xl font-bold text-purple-800 border-l-4 border-purple-500 pl-4 mb-6">✨ AI 流程問答助理</h2>
                <p class="mb-6 text-gray-600">對操作流程有疑問？隨時向 AI 助理提問！它已學習所有相關的SOP文件，能為您提供即時、準確的解答。請嘗試提問，例如：「如果CLKK手冊餘額不足怎麼辦？」</p>
                
                <div class="bg-purple-50 p-6 rounded-lg border border-purple-200">
                    <div id="chat-window" class="h-80 overflow-y-auto bg-white rounded-md p-4 flex flex-col space-y-4 mb-4 border">
                        <!-- Chat messages will appear here -->
                        <div class="chat-bubble ai-bubble">
                            你好！我是您的 AI 流程助理，請問有什麼可以幫到您？
                        </div>
                    </div>
                    <div id="ai-error" class="p-4 mb-4 bg-red-100 text-red-700 rounded-md hidden">
                        <p>抱歉，AI 助理目前無法回應，請稍後再試。</p>
                    </div>
                    <div class="flex">
                        <input type="text" id="user-question" class="flex-grow block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500" placeholder="在這裡輸入您的問題...">
                        <button id="send-btn" onclick="handleQuestion()" class="ml-2 inline-flex items-center justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 1.414L10.586 9H7a1 1 0 100 2h3.586l-1.293 1.293a1 1 0 101.414 1.414l3-3a1 1 0 000-1.414z" clip-rule="evenodd" /></svg>
                        </button>
                    </div>
                </div>
            </div>
        </section>

    </main>
    
    <footer class="bg-white mt-12 border-t">
        <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 text-center text-gray-500">
            <p>&copy; 2025 Avery Dennison - TKO 原料組內部培訓資源</p>
        </div>
    </footer>

    <!-- Popups -->
    <div class="info-popup-backdrop" id="popup-backdrop" onclick="closeAllPopups()"></div>
    
    <div id="popup1" class="info-popup bg-white rounded-lg shadow-2xl w-11/12 md:w-1/3">
        <div class="p-6">
            <h3 class="text-xl font-bold mb-2">訂單編號及項號</h3>
            <p>這是我們在 Oracle 系統中核對採購訂單的第一個關鍵資訊。必須確保送貨單上的PO號碼及項號與系統中的「PX Open Purchase Orders by Buyer (HK)」報表完全一致。</p>
        </div>
        <div class="bg-slate-50 p-4 text-right rounded-b-lg"><button onclick="closeAllPopups()" class="bg-blue-500 text-white py-2 px-5 rounded-md hover:bg-blue-600">關閉</button></div>
    </div>
    <div id="popup2" class="info-popup bg-white rounded-lg shadow-2xl w-11/12 md:w-1/3">
         <div class="p-6">
            <h3 class="text-xl font-bold mb-2">不同訂單不可混合在同一托盤</h3>
            <p>此規定是為了確保後續按訂單製作報關文件時，貨物資訊的清晰與準確。每一個托盤對應一份獨立の訂單，可以極大簡化後續的報關文件準備和海關查驗流程。</p>
        </div>
        <div class="bg-slate-50 p-4 text-right rounded-b-lg"><button onclick="closeAllPopups()" class="bg-blue-500 text-white py-2 px-5 rounded-md hover:bg-blue-600">關閉</button></div>
    </div>
    <div id="popup3" class="info-popup bg-white rounded-lg shadow-2xl w-11/12 md:w-1/3">
         <div class="p-6">
            <h3 class="text-xl font-bold mb-2">單個包裝貨物的毛重</h3>
            <p>單個包裝貨物(如紙箱, 桶裝, 木箱包裝..等)的毛重不得超過25公斤。這是基於人工搬運的安全考慮，同時也方便倉庫進行操作。</p>
        </div>
        <div class="bg-slate-50 p-4 text-right rounded-b-lg"><button onclick="closeAllPopups()" class="bg-blue-500 text-white py-2 px-5 rounded-md hover:bg-blue-600">關閉</button></div>
    </div>
    <div id="popup4" class="info-popup bg-white rounded-lg shadow-2xl w-11/12 md:w-1/3">
         <div class="p-6">
            <h3 class="text-xl font-bold mb-2">原產國 (Country of Origin)</h3>
            <p>供應商必須在送貨文件上清楚標明每項物料的原產國。這是製作報關文件時的必要資訊，對關稅計算和海關合規至關重要。</p>
        </div>
        <div class="bg-slate-50 p-4 text-right rounded-b-lg"><button onclick="closeAllPopups()" class="bg-blue-500 text-white py-2 px-5 rounded-md hover:bg-blue-600">關閉</button></div>
    </div>
    <div id="popup5" class="info-popup bg-white rounded-lg shadow-2xl w-11/12 md:w-1/3">
         <div class="p-6">
            <h3 class="text-xl font-bold mb-2">FSC 物料要求</h3>
            <p>如果收貨的物料是 FSC (森林管理委員會) 認證產品，供應商必須隨貨提供「FSC 聲明 (FSC claim)」和有效的「FSC CoC 證書」。收貨時必須嚴格核對這些文件。</p>
        </div>
        <div class="bg-slate-50 p-4 text-right rounded-b-lg"><button onclick="closeAllPopups()" class="bg-blue-500 text-white py-2 px-5 rounded-md hover:bg-blue-600">關閉</button></div>
    </div>
     <div id="popup6" class="info-popup bg-white rounded-lg shadow-2xl w-11/12 md:w-1/3">
         <div class="p-6">
            <h3 class="text-xl font-bold mb-2">詳細送貨文件</h3>
            <p>每次交貨都必須附有詳細的送貨文件，清楚列明托盤數量、每板的淨重和毛重等資訊，確保數據源頭的準確性。</p>
        </div>
        <div class="bg-slate-50 p-4 text-right rounded-b-lg"><button onclick="closeAllPopups()" class="bg-blue-500 text-white py-2 px-5 rounded-md hover:bg-blue-600">關閉</button></div>
    </div>
    <div id="popup7" class="info-popup bg-white rounded-lg shadow-2xl w-11/12 md:w-1/3">
         <div class="p-6">
            <h3 class="text-xl font-bold mb-2">實物外箱標籤要求</h3>
            <p>實體貨物的外箱包裝上，必須清楚標示：訂單編號、物料款號、數量、單位、淨重、毛重和原產國，確保實物與文件資訊一致。</p>
        </div>
        <div class="bg-slate-50 p-4 text-right rounded-b-lg"><button onclick="closeAllPopups()" class="bg-blue-500 text-white py-2 px-5 rounded-md hover:bg-blue-600">關閉</button></div>
    </div>
    <div id="popup8" class="info-popup bg-white rounded-lg shadow-2xl w-11/12 md:w-1/3">
         <div class="p-6">
            <h3 class="text-xl font-bold mb-2">核對卡板及包裝資訊</h3>
            <p>收貨時需檢查卡板(托盤)是否符合公司標準 (如尺寸不大於 1200x850mm)，且沒有損壞或腐爛。不允許使用原木材料，除非有 IPPC 標記。任何不合規的包裝都可能被拒收。</p>
        </div>
        <div class="bg-slate-50 p-4 text-right rounded-b-lg"><button onclick="closeAllPopups()" class="bg-blue-500 text-white py-2 px-5 rounded-md hover:bg-blue-600">關閉</button></div>
    </div>

    <div id="popup_truck" class="info-popup bg-white rounded-lg shadow-2xl w-11/12 md:w-1/3">
         <div class="p-6">
            <h3 class="text-xl font-bold mb-2">安排車輛</h3>
            <p>根據貨物的<strong>總毛重 (6500KG 或以下)</strong> 及 <strong>體積 (14 卡板或以下)</strong>，安排合適的中港貨車。這一步需要預先規劃，確保運輸資源的有效利用。</p>
        </div>
        <div class="bg-slate-50 p-4 text-right rounded-b-lg"><button onclick="closeAllPopups()" class="bg-green-500 text-white py-2 px-5 rounded-md hover:bg-green-600">關閉</button></div>
    </div>
    <div id="popup_crosscheck" class="info-popup bg-white rounded-lg shadow-2xl w-11/12 md:w-1/3">
         <div class="p-6">
            <h3 class="text-xl font-bold mb-2 text-red-700">單貨核對 (非常重要)</h3>
            <p>在裝車前，香港倉庫同事<strong>必須</strong>再次核對即將裝車的實物與報關裝箱單上的資料（如品名、數量、批號等）是否完全一致。這是防止報關錯誤的最後一道防線。</p>
        </div>
        <div class="bg-slate-50 p-4 text-right rounded-b-lg"><button onclick="closeAllPopups()" class="bg-red-500 text-white py-2 px-5 rounded-md hover:bg-red-600">關閉</button></div>
    </div>
    <div id="popup_rocars" class="info-popup bg-white rounded-lg shadow-2xl w-11/12 md:w-1/3">
         <div class="p-6">
            <h3 class="text-xl font-bold mb-2">香港出口申報 (Rocars)</h3>
            <p>在香港的「道路貨物資料系統 (Rocars)」中，進行電子預報貨物資料。<strong>此系統由香港 TKO 倉庫團隊負責操作</strong>，是香港出口的法定要求，必須在貨物離港前完成。</p>
        </div>
        <div class="bg-slate-50 p-4 text-right rounded-b-lg"><button onclick="closeAllPopups()" class="bg-green-500 text-white py-2 px-5 rounded-md hover:bg-green-600">關閉</button></div>
    </div>
    <div id="popup_mainland" class="info-popup bg-white rounded-lg shadow-2xl w-11/12 md:w-1/3">
         <div class="p-6">
            <h3 class="text-xl font-bold mb-2">內地進口申報 (公路艙單)</h3>
            <p>此步驟由<strong>內地南沙(NS)或番禺(PY)的報關組同事負責</strong>，他們會在內地的「公路艙單」系統進行電子預報。了解此環節有助於理解完整的進口鏈條。</p>
        </div>
        <div class="bg-slate-50 p-4 text-right rounded-b-lg"><button onclick="closeAllPopups()" class="bg-green-500 text-white py-2 px-5 rounded-md hover:bg-green-600">關閉</button></div>
    </div>
    <div id="popup_loading" class="info-popup bg-white rounded-lg shadow-2xl w-11/12 md:w-1/3">
         <div class="p-6">
            <h3 class="text-xl font-bold mb-2">裝車與文件交接</h3>
            <p>安排裝車，並將全套已蓋章的報關文件（六聯單、發票、裝箱單等）交給貨車司機。同時，將文件掃描件通過電郵發送給內地相關同事（倉庫、報關組），確保資訊同步。</p>
        </div>
        <div class="bg-slate-50 p-4 text-right rounded-b-lg"><button onclick="closeAllPopups()" class="bg-green-500 text-white py-2 px-5 rounded-md hover:bg-green-600">關閉</button></div>
    </div>


    <script>
        // --- 程式碼模組：UI 互動輔助函式 ---

        // 獲取所有互動元素
        const backdrop = document.getElementById('popup-backdrop');
        const popups = document.querySelectorAll('.info-popup');
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        const checklistItems = document.querySelectorAll('.checklist-item');
        const flipCards = document.querySelectorAll('.flip-card');

        /**
         * 顯示指定的彈出視窗
         * @param {string} popupId - 要顯示的彈出視窗的 ID
         */
        function showPopup(popupId) {
            const popup = document.getElementById(popupId);
            if (popup) {
                backdrop.classList.add('visible');
                popup.classList.add('visible');
            }
        }

        /**
         * 關閉所有彈出視窗
         */
        function closeAllPopups() {
            backdrop.classList.remove('visible');
            popups.forEach(p => p.classList.remove('visible'));
        }

        /**
         * 切換分頁標籤
         * @param {Event} evt - 點擊事件
         * @param {string} tabName - 要顯示的分頁內容 ID
         */
        function openTab(evt, tabName) {
            tabContents.forEach(tab => tab.style.display = 'none');
            tabButtons.forEach(btn => {
                btn.className = btn.className.replace(' bg-white text-indigo-600 border-b-2 border-indigo-500', ' bg-gray-100 text-gray-500');
            });
            document.getElementById(tabName).style.display = 'block';
            evt.currentTarget.className = evt.currentTarget.className.replace(' bg-gray-100 text-gray-500', ' bg-white text-indigo-600 border-b-2 border-indigo-500');
        }

        /**
         * 切換檢查清單項目的選中狀態
         * @param {HTMLElement} item - 被點擊的檢查清單項目
         */
        function toggleCheck(item) {
            item.classList.toggle('checked');
        }
        
        /**
         * 處理鍵盤事件，用於觸發互動元素的點擊
         * @param {KeyboardEvent} event - 鍵盤事件
         * @param {Function} action - 要執行的動作函式
         */
        function handleKeyPress(event, action) {
            if (event.key === 'Enter') {
                action();
            }
        }

        // --- 程式碼模組：AI 流程問答助理 ---

        const chatWindow = document.getElementById('chat-window');
        const userInput = document.getElementById('user-question');
        const sendBtn = document.getElementById('send-btn');
        const aiError = document.getElementById('ai-error');
        
        const config = {
            // AI 的上下文知識庫，基於所有 SOP 文件摘要
            sopContext: `
                SOP文件摘要:
                - LGW-38 & LGW-12 (一般貿易 GT): 香港倉庫(TKO)負責收貨，核對PO，準備六聯單、發票、裝箱單、合同。TKO在Rocars申報。內地報關組(NS/PY)核對文件，在公路艙單申報，並安排繳稅。新物料需內地採購/Sourcing提供「GT信息一覽表」或「归类要素一覽表」。
                - LGW-45 & LGW-44 (進料加工 CLKK): 內地報關組提供CLKK手冊資料。TKO收貨後判斷物料是否在手冊內。如是，則按手冊準備發票、裝箱單、六聯單。TKO在Rocars申報。如果手冊餘額不足或物料不符，需與內地報關組確認，可能轉為GT流程處理。
                - Oracle Orgs: CLKK模式下，南沙用NSB，番禺用PYB/PRB。GT模式下，南沙原料用NSL，零件/機器用NST；番禺原料用PYL/PRL，零件/機器用PYT。
                - 內部轉移: 存在內部公司間的GT轉移，如NST賣給NSL，PYT賣給PYL，用於補貨/Sample/零件，文件依據可能是內部轉移訂單(ICPO)。
                - 職責: Rocars由TKO倉負責，公路艙單由內地(PY/NS)報關組負責。
            `,
            // AI 的角色和回答風格指令
            systemPrompt: `
                你是一位 Avery Dennison TKO WH-T4 原料組的資深專家兼培訓導師。你的任務是根據以下提供的內部SOP文件摘要，準確回答新進人員關於原料進口流程的問題。

                **你的回答必須遵循以下寫作風格：**
                1.  **標題吸睛，開門見山：** 標題直接點出主題，多使用問號或驚嘆號！
                2.  **善用小標題和Emoji：** 使用小標題和表情符號 (如 ✅, 📝, 🗂️, 📍, 📢, 📖) 來分段，讓結構更清晰。
                3.  **語言簡潔，用詞直接：** 用生活化、易懂的詞語，避免專業術語。
                4.  **條列式說明：** 將重點用條列方式呈現，方便閱讀。
                5.  **舉例說明：** 用實際例子解釋流程，例如提到具體的 Oracle Org。
                6.  **結尾直接：** 直接結束回答，不需要提出引導性問題。

                **SOP文件摘要:** {{SOP_CONTEXT}}

                **重要規則：**
                - 請只根據提供的SOP文件摘要回答。
                - 如果問題超出資料範圍，請直接回答「我不知道這個問題的答案，請向 WHT4 主管 Tak 查詢。」

                現在，請用指定的寫作風格，回答以下問題: "{{USER_QUESTION}}"
            `
        };

        /**
         * 處理使用者提問並呼叫 Gemini API
         */
        async function handleQuestion() {
            const question = userInput.value.trim();
            if (!question) return;

            appendMessage(question, 'user');
            userInput.value = '';
            
            showTypingIndicator(true);
            aiError.classList.add('hidden');

            try {
                const prompt = config.systemPrompt
                    .replace('{{SOP_CONTEXT}}', config.sopContext)
                    .replace('{{USER_QUESTION}}', question);

                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                const payload = { contents: chatHistory };
                const apiKey = "sk-dtsyblrnmoqvyfojnwwhlakrxzablfkjcvxjhlqundpdbbjh"; // API key will be provided by the environment
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`API request failed with status ${response.status}`);
                }

                const result = await response.json();
                
                let aiResponse = "抱歉，無法獲取有效的回答。";
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    aiResponse = result.candidates[0].content.parts[0].text;
                }
                
                showTypingIndicator(false);
                appendMessage(aiResponse, 'ai');

            } catch (error) {
                console.error("Error calling Gemini API:", error);
                showTypingIndicator(false);
                const errorP = aiError.querySelector('p');
                if (error.message.includes("403")) {
                     errorP.innerHTML = "<strong>AI 助理權限錯誤 (403)！</strong><br>這表示 API 金鑰無權使用 Gemini API。請確認您的 Google Cloud 專案已啟用「Generative Language API」或「AI Platform」相關服務。";
                } else {
                    errorP.textContent = `抱歉，發生網路錯誤，請稍後再試。(${error.message})`;
                }
                aiError.classList.remove('hidden');
            }
        }

        /**
         * 在聊天視窗中新增訊息
         * @param {string} text - 訊息內容
         * @param {string} sender - 'user' 或 'ai'
         */
        function appendMessage(text, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('chat-bubble', sender === 'user' ? 'user-bubble' : 'ai-bubble');
            messageDiv.innerHTML = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            chatWindow.appendChild(messageDiv);
            chatWindow.scrollTop = chatWindow.scrollHeight; 
        }

        /**
         * 顯示或隱藏 AI 輸入中提示
         * @param {boolean} show - true 為顯示, false 為隱藏
         */
        function showTypingIndicator(show) {
            const existingIndicator = document.getElementById('typing-indicator');
            if (existingIndicator) {
                existingIndicator.remove();
            }

            if (show) {
                const indicatorDiv = document.createElement('div');
                indicatorDiv.id = 'typing-indicator';
                indicatorDiv.classList.add('chat-bubble', 'ai-bubble', 'typing-indicator');
                indicatorDiv.innerHTML = '<span></span><span></span><span></span>';
                chatWindow.appendChild(indicatorDiv);
                chatWindow.scrollTop = chatWindow.scrollHeight;
            }
        }
        
        // --- 程式碼模組：初始化與事件監聽 ---
        
        /**
         * 初始化所有事件監聽器
         */
        function initializeApp() {
            // 平滑滾動
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    document.querySelector(this.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });

            // AI 助理發送按鈕
            sendBtn.addEventListener('click', handleQuestion);
            userInput.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    handleQuestion();
                }
            });

            // 鍵盤導航支援
            document.querySelectorAll('[tabindex="0"]').forEach(element => {
                element.addEventListener('keydown', (event) => {
                    if (event.key === 'Enter') {
                        element.click();
                    }
                });
            });
        }

        // 當頁面載入完成後，執行初始化
        document.addEventListener('DOMContentLoaded', initializeApp);

    </script>
</body>
</html>

